import{L as W,i as X}from"./vue-countdown.esm.6b4e2aa9.js";import{p as Y,e as J,t as Q}from"./index.es.244fd0fc.js";import{a as M}from"./index.a5307fe9.js";import{H as Z,L as p,r as w,c as i,a as P,w as q,b as n,t as g,f as u,n as b,F as v,g as E,h as T,j as U,o,k as O}from"./app.6c999467.js";import{S as _}from"./sweetalert2.all.91dbb82a.js";import{_ as ee}from"./_plugin-vue_export-helper.cdc0426e.js";const te={layout:W,components:{Head:Z,Link:p,VueCountdown:X,MathJax:Y},props:{id:String,page:Number,exam:Object,setting:Object,duration:Object,questionLists:Object,section:Number,lastSection:Number,grade:Object,indexPage:Object},mounted(){let a=document.createElement("script");a.setAttribute("src","/assets/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"),document.head.appendChild(a);function l(){const t=document.getElementById("elementId");Q(t)}J({},l)},setup(a){var l,t=a.exam.id!=localStorage.getItem("examId")||a.grade.user_id!=localStorage.getItem("userId")||localStorage.getItem("indexPage")===null?0:parseInt(localStorage.getItem("indexPage"));l=w(t),localStorage.getItem("indexPage")===null&&localStorage.setItem("indexPage",0);let e=["A","B","C","D","E"];(a.exam.id!=localStorage.getItem("examId")||a.grade.user_id!=localStorage.getItem("userId"))&&(localStorage.setItem("examId",a.exam.id),localStorage.setItem("userId",a.grade.user_id),localStorage.setItem("myAnswers",[]));const A=localStorage.getItem("myAnswers");let m=A?JSON.parse(A):[];localStorage.setItem("myAnswers",JSON.stringify(m)),localStorage.setItem("examId",a.exam.id);const C=w(0),y=w(a.duration),s=w(0),r=()=>{y.value=y.value-1e3,C.value=C.value+1},k=()=>{s.value=s.value-1e3},S=()=>{let d=document.createElement("script");d.setAttribute("src","/assets/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"),document.head.appendChild(d);function c(){const h=document.getElementById("elementId");Q(h)}J({},c)},D=()=>{l.value=parseInt(l.value)-1,S()},N=()=>{l.value=parseInt(l.value)+1,S()},K=d=>{l.value=d,S()},H=()=>{if(a.setting.block_system_type==1){if(a.grade.is_blocked!=1&&a.exam.total_tolerance){let d=parseInt(a.grade.total_tolerance)>0?parseInt(a.grade.total_tolerance)-1:0,c=d==0?"Tolerasi habis, ":"Toleransi Tersisa "+d+" kali lagi, ";_.fire({title:"UJIAN AKAN DI DIBLOKIR JIKA ANDA MENINGGALKAN SESI UJIAN",text:c+" jika toleransi habis anda tidak dapat melanjutkan ujian dan harus menghubungi admin",icon:"warning",showCancelButton:!1,confirmButtonColor:"#d33",cancelButtonColor:"#d33",confirmButtonText:"Mengerti",allowOutsideClick:!1}).then(h=>{h.isConfirmed&&T.Inertia.post(`/user/exams/${a.exam.id}/decrement-tolerance`,{grade_id:a.grade.id},{onSuccess:()=>{d==0&&location.reload()}})})}}else a.setting.block_system_type==2&&_.fire({title:"Peringatan",text:"Hindari Membuka Tab atau Aplikasi Lain Selama Ujian. Fokuslah Pada Pertanyaan Selama Ujian Berlangsung.",icon:"warning",showCancelButton:!1,confirmButtonColor:"#d33",cancelButtonColor:"#d33",confirmButtonText:"Mengerti",allowOutsideClick:!1})},V=d=>{const c=m.find(h=>h.question_id===d);return c?c.answer:[]};let R=0;const z=(d,c)=>{const h=Number(c),f=m.findIndex(x=>x.question_id===d),L=a.questionLists[l.value].total_answer_limit;if(f!==-1)if(Array.isArray(m[f].answer))if(L===1)m[f].answer=[h];else if(m[f].answer.includes(h))m[f].answer=m[f].answer.filter(x=>x!==h);else if(m[f].answer.length<L)m[f].answer.push(h),m[f].answer.sort((x,j)=>x-j);else return _.fire({title:"Informasi",text:"Tidak dapat mengirim jawaban karena sudah mencapai batas. Silakan klik jawaban yang sudah ada untuk menghapusnya dan menggantinya dengan jawaban lain.",icon:"info",showCancelButton:!1,confirmButtonText:"Mengerti",allowOutsideClick:!1}),!1;else m[f].answer=[h];else m.push({question_id:d,answer:[h]});try{R%20===0&&I(),localStorage.setItem("myAnswers",JSON.stringify(m)),R++,l.value<Object.keys(a.questionLists).length-1&&a.exam.next_question_automatically==1&&L==(m[f]?m[f].answer.length:1)&&N(),localStorage.setItem("indexPage",l.value),l.value==Object.keys(a.questionLists).length-1&&a.exam.button_type_finish==3&&_.fire({title:"Informasi",text:"Anda sudah mengerjakan sampai soal terakhir, silakan akhiri, lanjut kebagian berikutnya atau tunggu waktu ujian hingga selesai.",icon:"info",showCancelButton:!1,confirmButtonText:"Mengerti",allowOutsideClick:!1})}catch(x){_.fire({title:"Error",text:"Submit Jawaban Error, silakan lakukan refresh dan pastikan perangkat terhubungan dengan jaringan."+x,icon:"error",showCancelButton:!1,confirmButtonText:"Refresh",allowOutsideClick:!1}).then(j=>{j.isConfirmed&&location.reload()})}},F=w(!1),I=()=>{M.get("/check-connection").then(d=>{}).catch(d=>{_.fire({title:"Error",text:`Submit Jawaban Error, silakan lakukan refresh dan pastikan perangkat terhubungan dengan jaringan.
`+d,icon:"error",showCancelButton:!1,confirmButtonText:"Refresh",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&location.reload()})})},B=(d="")=>{I(),a.section==a.lastSection||d=="block"?T.Inertia.post(`/user/exams/${a.exam.id}/exam-end`,{exam_id:a.exam.id,grade_id:a.grade.id,myAnswers:m},{onSuccess:()=>{d=="block"?_.fire({title:"UJIAN DIBLOKIR KARENA SUDAH MELEWATI BATAS TOLERANSI.",text:"Anda tidak dapat melanjutkan ujian, silakan hubungi admin",icon:"warning",showCancelButton:!1,confirmButtonColor:"#d33",confirmButtonText:"Mengerti",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&location.reload()}):a.exam.exam_group&&a.exam.exam_group.exam_group_navigation_mode==2?($("#questionExam").hide(),localStorage.setItem("indexPage",0),location.reload()):_.fire({title:"Success..",text:"Ujian Anda Selesai, Semoga Mendapatkan Nilai Terbaik.",icon:"success",showCancelButton:!1,confirmButtonText:"Tutup",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&(localStorage.setItem("indexPage",0),location.reload())})}}):($("#questionExam").hide(),localStorage.setItem("indexPage",0),T.Inertia.get(`/user/exams/${a.exam.id}/grades/${a.grade.id}/sections/${a.section+1}?nextsection=1`))},G=()=>{a.section==a.lastSection?_.fire({title:"Waktu Habis",text:"Waktu Tryout sudah berakhir! Klik Selesai untuk mengakhiri Tryout",icon:"warning",showCancelButton:!1,confirmButtonText:"Selesai",allowOutsideClick:!1}).then(d=>{d.isConfirmed&&B()}):B()};return a.setting.block_system_type!=0&&window.addEventListener("blur",H),a.grade.is_blocked==1&&_.fire({title:"Ujian di Blokir",text:"Masukan Kode Untuk Membuka Blokir",input:"text",icon:"error",inputAttributes:{autocapitalize:"off"},showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"Buka Blokir",showLoaderOnConfirm:!0,preConfirm:d=>{M.get(`/user/exams/${a.exam.id}/grades/${a.grade.id}/unblocked`,{params:{token:d}}).then(c=>{c.data.success==!0?_.fire({title:"Blokir Berhasil Dibuka",text:"Silakan Lanjut Mengerjakan Soal.",icon:"success",showCancelButton:!1,confirmButtonText:"Oke",allowOutsideClick:!1}).then(h=>{h.isConfirmed&&location.reload()}):_.fire({title:"Gagal",text:c.data.message,icon:"error",showCancelButton:!1,confirmButtonText:"Ulangi",allowOutsideClick:!1}).then(h=>{h.isConfirmed&&location.reload()})}).catch(c=>{console.error("Request failed:",c),_.showValidationMessage(`Request failed: ${c}`)})}}),{indexPage:l,options:e,duration:y,durationStartExam:s,handleChangeDuration:r,handleChangeDurationStartExam:k,prevPage:D,nextPage:N,clickQuestion:K,submitAnswer:z,getMyAnswer:V,showModalEndExam:F,endExam:B,confirm:H,checkConnection:I,loadMath:S,showQuestionExam:()=>{M.get(`/user/exams/${a.exam.id}/grades/${a.grade.id}/finished`).then(d=>{d.data.success==!0&&(d.data.is_finished==!0?($("#questionExam").hide(),$("#timeRemainingQuestion").hide(),_.fire({title:"Ujian Sudah Selesai",text:"Anda tidak dapat kembali ke sesi ujian karena ujian sudah berakhir.",icon:"error",showCancelButton:!1,confirmButtonText:"Oke",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&(localStorage.setItem("indexPage",0),location.reload())})):($("#questionExam").show(),$("#timeRemainingQuestion").hide()))}).catch(d=>{console.error("Request failed:",d),_.showValidationMessage(`Request failed: ${d}`)})},handeCountdownEnd:G}},methods:{transform(a){return Object.entries(a).forEach(([l,t])=>{const e=t<10?`0${t}`:t;a[l]=`${e}`}),a}}},ne={key:0,class:"alert alert-danger border-0 bg-danger alert-dismissible fade show py-2"},ae={class:"d-flex align-items-center"},ie=n("div",{class:"font-35 text-white"},[n("i",{class:"bx bxs-message-square-x"})],-1),oe={class:"ms-3"},se=n("h6",{class:"mb-0 text-white"},"Perhatian",-1),le={class:"text-white"},de={style:{background:"#fff",display:"none","justify-content":"center","align-items":"center",height:"100vh"},id:"timeRemainingQuestion"},re={class:"mb-0 text-center"},ce={style:{"font-size":"6vw"}},ue={style:{"font-size":"6vw"}},me={class:"row"},ge={class:"card"},he={class:"d-flex justify-content-between"},_e={class:"text-start"},fe={key:0},ke={class:"text-end"},xe=n("i",{class:"fadeIn animated bx bx-time-five"},null,-1),be={key:0},ye=n("i",{class:"bx bx-"},null,-1),we={key:1},ve=n("i",{class:"bx bx-"},null,-1),Ce={class:"card-body"},Se={key:0},Ee=["innerHTML"],Ae={key:0},Ie={width:"50",style:{padding:"10px"}},Be=["onClick"],Le=["onClick"],je={style:{padding:"10px"}},Me=["innerHTML"],Pe={key:1},qe={width:"30"},Te=["innerHTML"],Oe={key:1},Ne=n("div",{class:"alert alert-danger border-0 shadow"},[n("i",{class:"fa fa-exclamation-triangle"}),O(" Question Not Found!. ")],-1),He=[Ne],Re={key:0},Je=n("hr",{class:"mb-1"},null,-1),Qe=["onClick"],Ue=["onClick"],De={class:"card-footer"},Ke={class:"d-flex justify-content-between"},Ve={class:"text-start"},ze={key:0},Fe={key:0,class:"text-center",style:{"min-height":"35px"}},Ge={key:0},We={key:1},Xe={class:"card"},Ye=n("div",{class:"card-header text-white bg-primary"},[n("div",{class:"d-flex justify-content-between"},[n("div",null,[n("h5",{class:"mb-0 text-white"},"Navigasi Soal")])])],-1),Ze={class:"card-body",style:{height:"480px","overflow-y":"auto"}},$e={style:{width:"20%",float:"left"}},pe={style:{padding:"2px"}},et=["onClick"],tt={style:{"font-size":"11px","font-weight":"500"}},nt=["onClick"],at={style:{"font-size":"11px","font-weight":"500"}},it=["onClick"],ot={style:{"font-size":"11px","font-weight":"500"}},st={class:"card-footer",style:{"min-height":"60px"}},lt={key:0},dt={key:0},rt={key:1},ct={class:"modal-dialog"},ut={class:"modal-content"},mt=n("div",{class:"modal-header"},[n("h5",{class:"modal-title"},"Akhiri Tryout ?")],-1),gt=n("div",{class:"modal-body"}," Setelah mengakhiri Tryout, Anda tidak dapat kembali ke Tryout ini lagi. Yakin akan mengakhiri Tryout? ",-1),ht={class:"modal-footer"};function _t(a,l,t,e,A,m){const C=U("Head"),y=U("VueCountdown");return o(),i(v,null,[P(C,null,{default:q(()=>{var s;return[n("title",null,g((s=a.$page.props.setting.app_name)!=null?s:"Atur Setting Terlebih Dahulu")+" - Sesi Ujian",1)]}),_:1}),a.$page.props.session.error?(o(),i("div",ne,[n("div",ae,[ie,n("div",oe,[se,n("div",le,g(a.$page.props.session.error),1)])])])):u("",!0),n("div",de,[P(y,{time:e.durationStartExam,onProgress:e.handleChangeDurationStartExam,onEnd:e.showQuestionExam},{default:q(({seconds:s})=>[n("h2",re,[n("p",null,[n("span",ce,g(t.lastSection>1?"Persiapan Kolom "+t.section:"Ujian dimulai dari"),1)]),n("span",ue,g(s),1)])]),_:1},8,["time","onProgress","onEnd"])]),n("div",{class:b({"container-fluid":t.lastSection>1,container:t.lastSection<=1}),style:{"margin-top":"6vh",display:"none"},id:"questionExam"},[n("div",me,[n("div",{class:b(["col-md-12 col-sm-12 col-xs-12",t.exam.show_question_number_navigation==1?"col-lg-8":"col-lg-12"])},[n("div",ge,[n("div",{class:b(["card-header",{"bg-default":t.lastSection>1,"bg-primary":t.lastSection<=1}])},[n("div",he,[n("div",_e,[t.exam.show_question_number==1?(o(),i("div",fe,[n("h4",{class:b(["mb-0",{"text-dark":t.lastSection>1,"text-white":t.lastSection<=1}])},"No. "+g(t.questionLists[e.indexPage].navigation_order),3)])):u("",!0)]),n("div",ke,[P(y,{transform:m.transform,time:e.duration,onProgress:e.handleChangeDuration,onEnd:e.handeCountdownEnd},{default:q(({hours:s,minutes:r,seconds:k})=>[n("h4",{class:b(["mb-0",{"text-dark":t.lastSection>1,"text-white":t.lastSection<=1}])},[xe,t.exam.duration>=60?(o(),i("span",be,[ye,O(" "+g(s)+" : "+g(r)+" : "+g(k),1)])):(o(),i("span",we,[ve,O(" "+g(r)+" : "+g(k),1)]))],2)]),_:1},8,["transform","time","onProgress","onEnd"])])])],2),n("div",Ce,[t.questionLists[e.indexPage]?(o(),i("div",Se,[n("div",null,[n("div",{innerHTML:t.questionLists[e.indexPage].question,class:"prevent-select clearfix ck-content"},null,8,Ee)]),n("table",null,[t.exam.type_option==1?(o(),i("tbody",Ae,[(o(!0),i(v,null,E(t.questionLists[e.indexPage].answer_order.split(","),(s,r)=>(o(),i("tr",{key:r},[n("span",null,[n("td",Ie,[e.getMyAnswer(t.questionLists[e.indexPage].question_id).includes(Number(s))?(o(),i("button",{key:0,onClick:k=>e.submitAnswer(t.questionLists[e.indexPage].question_id,s),class:"btn btn-success text-white"},g(e.options[r]),9,Be)):(o(),i("button",{key:1,onClick:k=>e.submitAnswer(t.questionLists[e.indexPage].question_id,s),class:"btn btn-outline-primary w-100 no-click-effect"},g(e.options[r]),9,Le))]),n("td",je,[t.exam.show_answer==1?(o(),i("p",{key:0,class:"prevent-select ck-content",innerHTML:t.questionLists[e.indexPage]["option_"+s]},null,8,Me)):u("",!0)])])]))),128))])):u("",!0),t.exam.type_option==2?(o(),i("tbody",Pe,[t.exam.show_answer==1?(o(!0),i(v,{key:0},E(t.questionLists[e.indexPage].answer_order.split(","),(s,r)=>(o(),i("tr",{key:r},[n("td",qe,[n("p",null,g(e.options[r])+".",1)]),n("td",null,[n("p",{class:"ck-content",innerHTML:t.questionLists[e.indexPage]["option_"+s]},null,8,Te)])]))),128)):u("",!0)])):u("",!0)])])):(o(),i("div",Oe,He))]),t.exam.type_option==2?(o(),i("div",Re,[Je,(o(!0),i(v,null,E(t.questionLists[e.indexPage].answer_order.split(","),(s,r)=>(o(),i("span",{key:r},[e.getMyAnswer(t.questionLists[e.indexPage].question_id).includes(Number(s))?(o(),i("button",{key:0,onClick:k=>e.submitAnswer(t.questionLists[e.indexPage].question_id,s),class:"btn btn-secondary text-dark mx-lg-1 mx-md-1 mb-1 rounded-3 no-click-effect-section",style:{"background-color":"#ccc",width:"15%"}},g(e.options[r]),9,Qe)):(o(),i("button",{key:1,onClick:k=>e.submitAnswer(t.questionLists[e.indexPage].question_id,s),class:"btn btn-secondary mx-lg-1 mx-md-1 mb-1 rounded-3 text-dark no-click-effect-section",style:{"background-color":"#ccc",width:"15%"}},g(e.options[r]),9,Ue))]))),128))])):u("",!0),n("div",De,[n("div",Ke,[n("div",Ve,[t.exam.show_prev_next_button==1?(o(),i("div",ze,[e.indexPage>0?(o(),i("button",{key:0,onClick:l[0]||(l[0]=s=>e.prevPage()),type:"button",class:"btn btn-primary me-3"},"Sebelumnya")):u("",!0),e.indexPage<Object.keys(t.questionLists).length-1?(o(),i("button",{key:1,onClick:l[1]||(l[1]=s=>e.nextPage()),type:"button",class:"btn btn-success"},"Selanjutnya")):u("",!0)])):u("",!0)]),t.exam.show_question_number_navigation==0&&t.exam.button_type_finish!=3?(o(),i("div",Fe,[t.exam.button_type_finish==1?(o(),i("div",Ge,[t.section==t.lastSection?(o(),i("button",{key:0,onClick:l[2]||(l[2]=s=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):(o(),i("button",{key:1,onClick:l[3]||(l[3]=(...s)=>e.endExam&&e.endExam(...s)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya"))])):(o(),i("div",We,[t.section==t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(o(),i("button",{key:0,onClick:l[4]||(l[4]=s=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):u("",!0),t.section<t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(o(),i("button",{key:1,onClick:l[5]||(l[5]=(...s)=>e.endExam&&e.endExam(...s)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya")):u("",!0)]))])):u("",!0)])])])],2),t.exam.show_question_number_navigation==1?(o(),i("div",{key:0,class:b(["col-md-12 col-sm-12 col-xs-12",{"col-lg-4":t.exam.show_question_number_navigation==1}])},[n("div",Xe,[Ye,n("div",Ze,[(o(!0),i(v,null,E(t.questionLists,(s,r)=>(o(),i("div",{key:r},[n("div",$e,[n("div",pe,[r==e.indexPage?(o(),i("button",{key:0,onClick:k=>e.clickQuestion(r),class:"btn btn-primary w-100"},[n("span",tt,g(s.navigation_order),1)],8,et)):u("",!0),r!=e.indexPage&&e.getMyAnswer(s.question_id)==0?(o(),i("button",{key:1,onClick:k=>e.clickQuestion(r),class:"btn btn-light w-100"},[n("span",at,g(s.navigation_order),1)],8,nt)):u("",!0),r!=e.indexPage&&e.getMyAnswer(s.question_id)!=0?(o(),i("button",{key:2,onClick:k=>e.clickQuestion(r),class:"btn btn-success w-100"},[n("span",ot,g(s.navigation_order),1)],8,it)):u("",!0)])])]))),128))]),n("div",st,[t.exam.button_type_finish!=3?(o(),i("div",lt,[t.exam.button_type_finish==1?(o(),i("div",dt,[t.section==t.lastSection?(o(),i("button",{key:0,onClick:l[6]||(l[6]=s=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):(o(),i("button",{key:1,onClick:l[7]||(l[7]=(...s)=>e.endExam&&e.endExam(...s)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya"))])):(o(),i("div",rt,[t.section==t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(o(),i("button",{key:0,onClick:l[8]||(l[8]=s=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):u("",!0),t.section<t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(o(),i("button",{key:1,onClick:l[9]||(l[9]=(...s)=>e.endExam&&e.endExam(...s)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya")):u("",!0)]))])):u("",!0)])])],2)):u("",!0)])],2),e.showModalEndExam?(o(),i("div",{key:1,class:b(["modal fade",{show:e.showModalEndExam}]),tabindex:"-1","aria-hidden":"true",style:{display:"block"},role:"dialog"},[n("div",ct,[n("div",ut,[mt,gt,n("div",ht,[n("button",{onClick:l[10]||(l[10]=(...s)=>e.endExam&&e.endExam(...s)),type:"button",class:"btn btn-primary"},"Ya, Akhiri"),n("button",{onClick:l[11]||(l[11]=s=>e.showModalEndExam=!1),type:"button",class:"btn btn-secondary"},"Tutup")])])])],2)):u("",!0)],64)}const Ct=ee(te,[["render",_t]]);export{Ct as default};
