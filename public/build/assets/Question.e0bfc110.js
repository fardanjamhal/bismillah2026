import{L as W,i as X}from"./vue-countdown.esm.89aadfce.js";import{p as Y,e as J,t as Q}from"./index.es.17dc9dea.js";import{a as q}from"./index.c5185775.js";import{H as Z,L as p,r as w,c as s,a as j,w as P,b as i,t as g,g as u,n as b,F as v,h as E,k as T,i as O,j as U,o as l}from"./app.c75ce23b.js";import{S as k}from"./sweetalert2.esm.all.089855d2.js";import{_ as ee}from"./_plugin-vue_export-helper.cdc0426e.js";const te={layout:W,components:{Head:Z,Link:p,VueCountdown:X,MathJax:Y},props:{id:String,page:Number,exam:Object,setting:Object,duration:Object,questionLists:Object,section:Number,lastSection:Number,grade:Object,indexPage:Object},mounted(){let a=document.createElement("script");a.setAttribute("src","/assets/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"),document.head.appendChild(a);function n(){const t=document.getElementById("elementId");Q(t)}J({},n)},setup(a){var n,t=a.exam.id!=localStorage.getItem("examId")||a.grade.user_id!=localStorage.getItem("userId")||localStorage.getItem("indexPage")===null?0:parseInt(localStorage.getItem("indexPage"));n=w(t),localStorage.getItem("indexPage")===null&&localStorage.setItem("indexPage",0);let e=["A","B","C","D","E"];(a.exam.id!=localStorage.getItem("examId")||a.grade.user_id!=localStorage.getItem("userId"))&&(localStorage.setItem("examId",a.exam.id),localStorage.setItem("userId",a.grade.user_id),localStorage.setItem("myAnswers",[]));const A=localStorage.getItem("myAnswers");let m=A?JSON.parse(A):[];localStorage.setItem("myAnswers",JSON.stringify(m)),localStorage.setItem("examId",a.exam.id);const C=w(0),y=w(a.duration),o=w(0),r=()=>{y.value=y.value-1e3,C.value=C.value+1},f=()=>{o.value=o.value-1e3},S=()=>{let d=document.createElement("script");d.setAttribute("src","/assets/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"),document.head.appendChild(d);function c(){const h=document.getElementById("elementId");Q(h)}J({},c)},D=()=>{n.value=parseInt(n.value)-1,S()},N=()=>{n.value=parseInt(n.value)+1,S()},K=d=>{n.value=d,S()},H=()=>{if(a.setting.block_system_type==1){if(a.grade.is_blocked!=1&&a.exam.total_tolerance){let d=parseInt(a.grade.total_tolerance)>0?parseInt(a.grade.total_tolerance)-1:0,c=d==0?"Tolerasi habis, ":"Toleransi Tersisa "+d+" kali lagi, ";k.fire({title:"UJIAN AKAN DI DIBLOKIR JIKA ANDA MENINGGALKAN SESI UJIAN",text:c+" jika toleransi habis anda tidak dapat melanjutkan ujian dan harus menghubungi admin",icon:"warning",showCancelButton:!1,confirmButtonColor:"#d33",cancelButtonColor:"#d33",confirmButtonText:"Mengerti",allowOutsideClick:!1}).then(h=>{h.isConfirmed&&O.Inertia.post(`/user/exams/${a.exam.id}/decrement-tolerance`,{grade_id:a.grade.id},{onSuccess:()=>{d==0&&location.reload()}})})}}else a.setting.block_system_type==2&&k.fire({title:"Peringatan",text:"Hindari Membuka Tab atau Aplikasi Lain Selama Ujian. Fokuslah Pada Pertanyaan Selama Ujian Berlangsung.",icon:"warning",showCancelButton:!1,confirmButtonColor:"#d33",cancelButtonColor:"#d33",confirmButtonText:"Mengerti",allowOutsideClick:!1})},V=d=>{const c=m.find(h=>h.question_id===d);return c?c.answer:[]};let R=0;const z=(d,c)=>{const h=Number(c),x=m.findIndex(_=>_.question_id===d),M=a.questionLists[n.value].total_answer_limit;if(x!==-1)if(Array.isArray(m[x].answer))if(M===1)m[x].answer=[h];else if(m[x].answer.includes(h))m[x].answer=m[x].answer.filter(_=>_!==h);else if(m[x].answer.length<M)m[x].answer.push(h),m[x].answer.sort((_,B)=>_-B);else return k.fire({title:"Informasi",text:"Tidak dapat mengirim jawaban karena sudah mencapai batas. Silakan klik jawaban yang sudah ada untuk menghapusnya dan menggantinya dengan jawaban lain.",icon:"info",showCancelButton:!1,confirmButtonText:"Mengerti",allowOutsideClick:!1}),!1;else m[x].answer=[h];else m.push({question_id:d,answer:[h]});try{R%20===0&&I(),localStorage.setItem("myAnswers",JSON.stringify(m)),R++,n.value<Object.keys(a.questionLists).length-1&&a.exam.next_question_automatically==1&&M==(m[x]?m[x].answer.length:1)&&N(),localStorage.setItem("indexPage",n.value),n.value==Object.keys(a.questionLists).length-1&&a.exam.button_type_finish==3&&k.fire({title:"Informasi",text:"Anda sudah mengerjakan sampai soal terakhir, silakan akhiri, lanjut kebagian berikutnya atau tunggu waktu ujian hingga selesai.",icon:"info",showCancelButton:!1,confirmButtonText:"Mengerti",allowOutsideClick:!1})}catch(_){k.fire({title:"Error",text:"Submit Jawaban Error, silakan lakukan refresh dan pastikan perangkat terhubungan dengan jaringan."+_,icon:"error",showCancelButton:!1,confirmButtonText:"Refresh",allowOutsideClick:!1}).then(B=>{B.isConfirmed&&location.reload()})}},F=w(!1),I=()=>{q.get("/check-connection").then(d=>{}).catch(d=>{k.fire({title:"Error",text:`Submit Jawaban Error, silakan lakukan refresh dan pastikan perangkat terhubungan dengan jaringan.
`+d,icon:"error",showCancelButton:!1,confirmButtonText:"Refresh",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&location.reload()})})},L=(d="")=>{I(),a.section==a.lastSection||d=="block"?O.Inertia.post(`/user/exams/${a.exam.id}/exam-end`,{exam_id:a.exam.id,grade_id:a.grade.id,myAnswers:m},{onSuccess:()=>{d=="block"?k.fire({title:"UJIAN DIBLOKIR KARENA SUDAH MELEWATI BATAS TOLERANSI.",text:"Anda tidak dapat melanjutkan ujian, silakan hubungi admin",icon:"warning",showCancelButton:!1,confirmButtonColor:"#d33",confirmButtonText:"Mengerti",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&location.reload()}):a.exam.exam_group&&a.exam.exam_group.exam_group_navigation_mode==2?($("#questionExam").hide(),localStorage.setItem("indexPage",0),location.reload()):k.fire({title:"Success..",text:"Ujian Anda Selesai, Semoga Mendapatkan Nilai Terbaik.",icon:"success",showCancelButton:!1,confirmButtonText:"Tutup",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&(localStorage.setItem("indexPage",0),location.reload())})}}):($("#questionExam").hide(),localStorage.setItem("indexPage",0),O.Inertia.get(`/user/exams/${a.exam.id}/grades/${a.grade.id}/sections/${a.section+1}?nextsection=1`))},G=()=>{a.section==a.lastSection?k.fire({title:"Waktu Habis",text:"Waktu Tryout sudah berakhir! Klik Selesai untuk mengakhiri Tryout",icon:"warning",showCancelButton:!1,confirmButtonText:"Selesai",allowOutsideClick:!1}).then(d=>{d.isConfirmed&&L()}):L()};return a.setting.block_system_type!=0&&window.addEventListener("blur",H),a.grade.is_blocked==1&&k.fire({title:"Ujian di Blokir",text:"Masukan Kode Untuk Membuka Blokir",input:"text",icon:"error",inputAttributes:{autocapitalize:"off"},showCancelButton:!1,allowOutsideClick:!1,confirmButtonText:"Buka Blokir",showLoaderOnConfirm:!0,preConfirm:d=>{q.get(`/user/exams/${a.exam.id}/grades/${a.grade.id}/unblocked`,{params:{token:d}}).then(c=>{c.data.success==!0?k.fire({title:"Blokir Berhasil Dibuka",text:"Silakan Lanjut Mengerjakan Soal.",icon:"success",showCancelButton:!1,confirmButtonText:"Oke",allowOutsideClick:!1}).then(h=>{h.isConfirmed&&location.reload()}):k.fire({title:"Gagal",text:c.data.message,icon:"error",showCancelButton:!1,confirmButtonText:"Ulangi",allowOutsideClick:!1}).then(h=>{h.isConfirmed&&location.reload()})}).catch(c=>{console.error("Request failed:",c),k.showValidationMessage(`Request failed: ${c}`)})}}),{indexPage:n,options:e,duration:y,durationStartExam:o,handleChangeDuration:r,handleChangeDurationStartExam:f,prevPage:D,nextPage:N,clickQuestion:K,submitAnswer:z,getMyAnswer:V,showModalEndExam:F,endExam:L,confirm:H,checkConnection:I,loadMath:S,showQuestionExam:()=>{q.get(`/user/exams/${a.exam.id}/grades/${a.grade.id}/finished`).then(d=>{d.data.success==!0&&(d.data.is_finished==!0?($("#questionExam").hide(),$("#timeRemainingQuestion").hide(),k.fire({title:"Ujian Sudah Selesai",text:"Anda tidak dapat kembali ke sesi ujian karena ujian sudah berakhir.",icon:"error",showCancelButton:!1,confirmButtonText:"Oke",allowOutsideClick:!1}).then(c=>{c.isConfirmed&&(localStorage.setItem("indexPage",0),location.reload())})):($("#questionExam").show(),$("#timeRemainingQuestion").hide()))}).catch(d=>{console.error("Request failed:",d),k.showValidationMessage(`Request failed: ${d}`)})},handeCountdownEnd:G}},methods:{transform(a){return Object.entries(a).forEach(([n,t])=>{const e=t<10?`0${t}`:t;a[n]=`${e}`}),a}}},ne={key:0,class:"alert alert-danger border-0 bg-danger alert-dismissible fade show py-2"},ie={class:"d-flex align-items-center"},ae={class:"ms-3"},oe={class:"text-white"},se={style:{background:"#fff",display:"none","justify-content":"center","align-items":"center",height:"100vh"},id:"timeRemainingQuestion"},le={class:"mb-0 text-center"},de={style:{"font-size":"6vw"}},re={style:{"font-size":"6vw"}},ce={class:"row"},ue={class:"card"},me={class:"d-flex justify-content-between"},ge={class:"text-start"},he={key:0},ke={class:"text-end"},fe={key:0},xe={key:1},be={class:"card-body"},_e={key:0},ye=["innerHTML"],we={key:0},ve={width:"50",style:{padding:"10px"}},Ce=["onClick"],Se=["onClick"],Ee={style:{padding:"10px"}},Ae=["innerHTML","onClick","onMouseleave"],Ie={key:1},Le={width:"30"},Me=["innerHTML"],Be={key:1},qe={key:0},je=["onClick"],Pe=["onClick"],Te={class:"card-footer"},Oe={class:"d-flex justify-content-center align-items-center"},Ne={class:"text-start"},He={key:0},Re={key:0,class:"text-center",style:{"min-height":"35px"}},Je={key:0},Qe={key:1},Ue={class:"card"},De={class:"card-body",style:{height:"480px","overflow-y":"auto"}},Ke={style:{width:"20%",float:"left"}},Ve={style:{padding:"2px"}},ze=["onClick"],Fe={style:{"font-size":"11px","font-weight":"500"}},Ge=["onClick"],We={style:{"font-size":"11px","font-weight":"500"}},Xe=["onClick"],Ye={style:{"font-size":"11px","font-weight":"500"}},Ze={class:"card-footer",style:{"min-height":"60px"}},$e={key:0},pe={key:0},et={key:1},tt={class:"modal-dialog"},nt={class:"modal-content"},it={class:"modal-footer"};function at(a,n,t,e,A,m){const C=U("Head"),y=U("VueCountdown");return l(),s(v,null,[j(C,null,{default:P(()=>{var o;return[i("title",null,g((o=a.$page.props.setting.app_name)!=null?o:"Atur Setting Terlebih Dahulu")+" - Sesi Ujian",1)]}),_:1}),a.$page.props.session.error?(l(),s("div",ne,[i("div",ie,[n[14]||(n[14]=i("div",{class:"font-35 text-white"},[i("i",{class:"bx bxs-message-square-x"})],-1)),i("div",ae,[n[13]||(n[13]=i("h6",{class:"mb-0 text-white"},"Perhatian",-1)),i("div",oe,g(a.$page.props.session.error),1)])])])):u("",!0),i("div",se,[j(y,{time:e.durationStartExam,onProgress:e.handleChangeDurationStartExam,onEnd:e.showQuestionExam},{default:P(({seconds:o})=>[i("h2",le,[i("p",null,[i("span",de,g(t.lastSection>1?"Persiapan Kolom "+t.section:"Ujian dimulai dari"),1)]),i("span",re,g(o),1)])]),_:1},8,["time","onProgress","onEnd"])]),i("div",{class:b({"container-fluid":t.lastSection>1,container:t.lastSection<=1}),style:{"margin-top":"6vh",display:"none"},id:"questionExam"},[i("div",ce,[i("div",{class:b(["col-md-12 col-sm-12 col-xs-12",t.exam.show_question_number_navigation==1?"col-lg-8":"col-lg-12"])},[i("div",ue,[i("div",{class:b(["card-header",{"bg-default":t.lastSection>1,"bg-primary":t.lastSection<=1}])},[i("div",me,[i("div",ge,[t.exam.show_question_number==1?(l(),s("div",he,[i("h4",{class:b(["mb-0",{"text-dark":t.lastSection>1,"text-white":t.lastSection<=1}])},"No. "+g(t.questionLists[e.indexPage].navigation_order),3)])):u("",!0)]),i("div",ke,[j(y,{transform:m.transform,time:e.duration,onProgress:e.handleChangeDuration,onEnd:e.handeCountdownEnd},{default:P(({hours:o,minutes:r,seconds:f})=>[i("h4",{class:b(["mb-0",{"text-dark":t.lastSection>1,"text-white":t.lastSection<=1}])},[n[17]||(n[17]=i("i",{class:"fadeIn animated bx bx-time-five"},null,-1)),t.exam.duration>=60?(l(),s("span",fe,[n[15]||(n[15]=i("i",{class:"bx bx-"},null,-1)),T(" "+g(o)+" : "+g(r)+" : "+g(f),1)])):(l(),s("span",xe,[n[16]||(n[16]=i("i",{class:"bx bx-"},null,-1)),T(" "+g(r)+" : "+g(f),1)]))],2)]),_:1},8,["transform","time","onProgress","onEnd"])])])],2),i("div",be,[t.questionLists[e.indexPage]?(l(),s("div",_e,[i("div",null,[i("div",{innerHTML:t.questionLists[e.indexPage].question,class:"prevent-select clearfix ck-content"},null,8,ye)]),n[18]||(n[18]=i("br",null,null,-1)),i("table",null,[t.exam.type_option==1?(l(),s("tbody",we,[(l(!0),s(v,null,E(t.questionLists[e.indexPage].answer_order.split(","),(o,r)=>(l(),s("tr",{key:r},[i("span",null,[i("td",ve,[e.getMyAnswer(t.questionLists[e.indexPage].question_id).includes(Number(o))?(l(),s("button",{key:0,onClick:f=>e.submitAnswer(t.questionLists[e.indexPage].question_id,o),class:"btn btn-success text-white"},g(e.options[r]),9,Ce)):(l(),s("button",{key:1,onClick:f=>e.submitAnswer(t.questionLists[e.indexPage].question_id,o),class:"btn btn-outline-primary w-100 no-click-effect"},g(e.options[r]),9,Se))]),i("td",Ee,[t.exam.show_answer==1?(l(),s("p",{key:0,class:b(["prevent-select ck-content",e.getMyAnswer(t.questionLists[e.indexPage].question_id).includes(Number(o))?"text-success fw-bold":""]),innerHTML:t.questionLists[e.indexPage]["option_"+o],onClick:f=>e.submitAnswer(t.questionLists[e.indexPage].question_id,o),style:{cursor:"pointer",transition:"color 0.2s"},onMouseover:n[0]||(n[0]=f=>a.event.currentTarget.style.color="#0d6efd"),onMouseleave:f=>a.event.currentTarget.style.color=e.getMyAnswer(t.questionLists[e.indexPage].question_id).includes(Number(o))?"#198754":"inherit"},null,42,Ae)):u("",!0)])])]))),128))])):u("",!0),t.exam.type_option==2?(l(),s("tbody",Ie,[t.exam.show_answer==1?(l(!0),s(v,{key:0},E(t.questionLists[e.indexPage].answer_order.split(","),(o,r)=>(l(),s("tr",{key:r},[i("td",Le,[i("p",null,g(e.options[r])+".",1)]),i("td",null,[i("p",{class:"ck-content",innerHTML:t.questionLists[e.indexPage]["option_"+o]},null,8,Me)])]))),128)):u("",!0)])):u("",!0)])])):(l(),s("div",Be,[...n[19]||(n[19]=[i("div",{class:"alert alert-danger border-0 shadow"},[i("i",{class:"fa fa-exclamation-triangle"}),T(" Question Not Found!. ")],-1)])]))]),t.exam.type_option==2?(l(),s("div",qe,[n[20]||(n[20]=i("hr",{class:"mb-1"},null,-1)),(l(!0),s(v,null,E(t.questionLists[e.indexPage].answer_order.split(","),(o,r)=>(l(),s("span",{key:r},[e.getMyAnswer(t.questionLists[e.indexPage].question_id).includes(Number(o))?(l(),s("button",{key:0,onClick:f=>e.submitAnswer(t.questionLists[e.indexPage].question_id,o),class:"btn btn-secondary text-dark mx-lg-1 mx-md-1 mb-1 rounded-3 no-click-effect-section",style:{"background-color":"#ccc",width:"15%"}},g(e.options[r]),9,je)):(l(),s("button",{key:1,onClick:f=>e.submitAnswer(t.questionLists[e.indexPage].question_id,o),class:"btn btn-secondary mx-lg-1 mx-md-1 mb-1 rounded-3 text-dark no-click-effect-section",style:{"background-color":"#ccc",width:"15%"}},g(e.options[r]),9,Pe))]))),128))])):u("",!0),i("div",Te,[i("div",Oe,[i("div",Ne,[t.exam.show_prev_next_button==1?(l(),s("div",He,[e.indexPage>0?(l(),s("button",{key:0,onClick:n[1]||(n[1]=o=>e.prevPage()),type:"button",class:"btn btn-primary me-3"},"Sebelumnya")):u("",!0),e.indexPage<Object.keys(t.questionLists).length-1?(l(),s("button",{key:1,onClick:n[2]||(n[2]=o=>e.nextPage()),type:"button",class:"btn btn-success"},"Selanjutnya")):u("",!0)])):u("",!0)]),t.exam.show_question_number_navigation==0&&t.exam.button_type_finish!=3?(l(),s("div",Re,[t.exam.button_type_finish==1?(l(),s("div",Je,[t.section==t.lastSection?(l(),s("button",{key:0,onClick:n[3]||(n[3]=o=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):(l(),s("button",{key:1,onClick:n[4]||(n[4]=(...o)=>e.endExam&&e.endExam(...o)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya"))])):(l(),s("div",Qe,[t.section==t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(l(),s("button",{key:0,onClick:n[5]||(n[5]=o=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):u("",!0),t.section<t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(l(),s("button",{key:1,onClick:n[6]||(n[6]=(...o)=>e.endExam&&e.endExam(...o)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya")):u("",!0)]))])):u("",!0)])])])],2),t.exam.show_question_number_navigation==1?(l(),s("div",{key:0,class:b(["col-md-12 col-sm-12 col-xs-12",{"col-lg-4":t.exam.show_question_number_navigation==1}])},[i("div",Ue,[n[21]||(n[21]=i("div",{class:"card-header text-white bg-primary"},[i("div",{class:"d-flex justify-content-center align-items-center"},[i("div",null,[i("h5",{class:"mb-0 text-white"},"Navigasi Soal")])])],-1)),i("div",De,[(l(!0),s(v,null,E(t.questionLists,(o,r)=>(l(),s("div",{key:r},[i("div",Ke,[i("div",Ve,[r==e.indexPage?(l(),s("button",{key:0,onClick:f=>e.clickQuestion(r),class:"btn btn-primary w-100"},[i("span",Fe,g(o.navigation_order),1)],8,ze)):u("",!0),r!=e.indexPage&&e.getMyAnswer(o.question_id)==0?(l(),s("button",{key:1,onClick:f=>e.clickQuestion(r),class:"btn btn-light w-100"},[i("span",We,g(o.navigation_order),1)],8,Ge)):u("",!0),r!=e.indexPage&&e.getMyAnswer(o.question_id)!=0?(l(),s("button",{key:2,onClick:f=>e.clickQuestion(r),class:"btn btn-success w-100"},[i("span",Ye,g(o.navigation_order),1)],8,Xe)):u("",!0)])])]))),128))]),i("div",Ze,[t.exam.button_type_finish!=3?(l(),s("div",$e,[t.exam.button_type_finish==1?(l(),s("div",pe,[t.section==t.lastSection?(l(),s("button",{key:0,onClick:n[7]||(n[7]=o=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):(l(),s("button",{key:1,onClick:n[8]||(n[8]=(...o)=>e.endExam&&e.endExam(...o)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya"))])):(l(),s("div",et,[t.section==t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(l(),s("button",{key:0,onClick:n[9]||(n[9]=o=>e.showModalEndExam=!0),class:"btn btn-danger btn-md border-0 shadow w-100"},"Akhiri Tryout")):u("",!0),t.section<t.lastSection&&e.indexPage>=Object.keys(t.questionLists).length-1?(l(),s("button",{key:1,onClick:n[10]||(n[10]=(...o)=>e.endExam&&e.endExam(...o)),class:"btn btn-danger btn-md border-0 shadow w-100"},"Lanjut Bagian Berikutnya")):u("",!0)]))])):u("",!0)])])],2)):u("",!0)])],2),e.showModalEndExam?(l(),s("div",{key:1,class:b(["modal fade",{show:e.showModalEndExam}]),tabindex:"-1","aria-hidden":"true",style:{display:"block"},role:"dialog"},[i("div",tt,[i("div",nt,[n[22]||(n[22]=i("div",{class:"modal-header"},[i("h5",{class:"modal-title"},"Akhiri Tryout ?")],-1)),n[23]||(n[23]=i("div",{class:"modal-body"}," Setelah mengakhiri Tryout, Anda tidak dapat kembali ke Tryout ini lagi. Yakin akan mengakhiri Tryout? ",-1)),i("div",it,[i("button",{onClick:n[11]||(n[11]=(...o)=>e.endExam&&e.endExam(...o)),type:"button",class:"btn btn-primary"},"Ya, Akhiri"),i("button",{onClick:n[12]||(n[12]=o=>e.showModalEndExam=!1),type:"button",class:"btn btn-secondary"},"Tutup")])])])],2)):u("",!0)],64)}const mt=ee(te,[["render",at]]);export{mt as default};
